# PHASE 7.1: 카메라 화면 비율(Aspect Ratio) 및 레터박스 구현 계획

**목표:** 사용자가 지정된 화면 비율(예: 16:9, 2.35:1)을 선택하고, 해당 비율이 적용된 화면을 3D 뷰포트에서 시각적으로 확인할 수 있는 기능을 구현합니다. 이 기능은 최종 이미지 캡처의 기반이 됩니다.

---

## 1. 상태 관리: 화면 비율 상태 추가 (`store.js`)

**설명:** 현재 카메라의 화면 비율과 레터박스 활성화 여부를 중앙에서 관리할 수 있도록 Zustand 스토어에 새로운 상태와 액션을 추가합니다.

1.  **`aspectRatio` 상태 추가**
    -   `cameraState` 객체 내부에 `aspectRatio` 속성을 추가합니다. (기본값: `'free'`)
    -   사용 가능한 비율 목록을 상수로 정의합니다. (예: `['free', '16:9', '1:1', '2.35:1']`)

2.  **`setAspectRatio` 액션 추가**
    -   `cameraState`의 `aspectRatio` 값을 변경하는 액션을 스토어에 추가합니다.

---

## 2. UI 구현: 화면 비율 선택기 (`EditorPanel.jsx`)

**설명:** 사용자가 화면 비율을 선택할 수 있는 UI를 컨트롤 패널에 추가합니다.

1.  **`Scene` 탭에 선택기 추가**
    -   `EditorPanel.jsx`의 `Scene` 탭 내부에 화면 비율을 선택할 수 있는 UI를 추가합니다.
    -   shadcn/ui의 `<Select>` 컴포넌트를 사용하여 드롭다운 메뉴로 구현하는 것을 추천합니다.

2.  **상태와 UI 연동**
    -   `<Select>` 컴포넌트의 `onValueChange` 이벤트를 통해 `setAspectRatio` 액션을 호출하여 스토어의 상태를 업데이트합니다.

---

## 3. 3D 뷰포트 구현: 레터박스(Letterbox) 렌더링 (`Scene.jsx`)

**설명:** 선택된 화면 비율을 3D 뷰포트에서 시각적으로 표현하기 위해, 화면의 남는 영역을 어둡게 처리하는 레터박스를 구현합니다. 이 방법은 실제 3D 캔버스의 크기를 변경하지 않으면서도 최종 결과물을 미리 볼 수 있게 해주는 효율적인 방식입니다.

1.  **레터박스 컴포넌트 생성**
    -   화면 전체를 덮는 HTML `<div>` 요소를 `Scene.jsx`의 최상단, `<Canvas>` 위쪽에 추가합니다.
    -   이 `<div>`는 4개의 자식 `<div>`(상, 하, 좌, 우)를 가집니다. 이 자식 `<div>`들이 레터박스의 검은색 바(bar) 역할을 합니다.
    -   `pointer-events: none;` CSS 속성을 적용하여 레터박스가 3D 캔버스의 마우스 이벤트를 가로채지 않도록 합니다.

2.  **화면 비율에 따른 동적 스타일링**
    -   `useEffect` 훅을 사용하여 윈도우의 크기와 스토어의 `aspectRatio` 상태를 구독합니다.
    -   현재 윈도우의 가로/세로 비율과 목표 화면 비율을 비교하여, 레터박스를 구성하는 4개 `<div>`의 `width` 또는 `height`를 동적으로 계산하고 스타일을 적용합니다.
    -   **예시 로직**:
        -   만약 현재 화면이 목표 비율보다 가로로 더 넓다면, 좌우에 검은색 바(bar)를 만듭니다. (상하 바는 `height: 0`)
        -   만약 현재 화면이 목표 비율보다 세로로 더 길다면, 상하에 검은색 바(bar)를 만듭니다. (좌우 바는 `width: 0`)

3.  **가상 카메라(Virtual Camera) 연동**
    -   `Scene.jsx`의 `Experience` 컴포넌트 내부에서, 실제 렌더링에 사용되는 `camera`가 아닌, 화면 비율을 적용할 **가상 카메라(`virtualCamera`)**의 `aspect` 값을 선택된 비율에 맞게 업데이트합니다.
    -   이렇게 하면, 나중에 캡처 기능을 구현할 때 레터박스가 적용된 영역만큼만 정확하게 캡처할 수 있습니다.

---

**결론:** 이 계획을 통해 사용자는 최종 결과물의 화면 비율을 직관적으로 미리 볼 수 있게 됩니다. 먼저 스토어와 UI를 구현한 뒤, 가장 복잡한 동적 레터박스 렌더링 로직을 구현하는 순서로 진행하는 것을 추천합니다.
